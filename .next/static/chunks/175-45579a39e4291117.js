"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[175],{3133:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.useNotifications=t.NotificationProvider=void 0;let i=r(7437),o=r(2265),a=r(7201),n={notifications:[],unreadCount:0,isLoading:!1,error:null,lastUpdated:null},u=(0,o.createContext)(void 0);function s(e,t){switch(t.type){case"FETCH_NOTIFICATIONS_REQUEST":return{...e,isLoading:!0,error:null};case"FETCH_NOTIFICATIONS_SUCCESS":return{...e,notifications:t.payload,unreadCount:t.payload.filter(e=>!e.read).length,isLoading:!1,error:null,lastUpdated:new Date};case"FETCH_NOTIFICATIONS_FAILURE":return{...e,isLoading:!1,error:t.payload};case"ADD_NOTIFICATION":return{...e,notifications:[t.payload,...e.notifications],unreadCount:e.unreadCount+(t.payload.read?0:1),lastUpdated:new Date};case"MARK_AS_READ":return{...e,notifications:e.notifications.map(e=>e.id===t.payload?{...e,read:!0}:e),unreadCount:e.unreadCount-(e.notifications.find(e=>e.id===t.payload&&!e.read)?1:0),lastUpdated:new Date};case"MARK_ALL_AS_READ":return{...e,notifications:e.notifications.map(e=>({...e,read:!0})),unreadCount:0,lastUpdated:new Date};case"DELETE_NOTIFICATION":let r=e.notifications.find(e=>e.id===t.payload);return{...e,notifications:e.notifications.filter(e=>e.id!==t.payload),unreadCount:e.unreadCount-(r&&!r.read?1:0),lastUpdated:new Date};case"CLEAR_ALL_NOTIFICATIONS":return{...e,notifications:[],unreadCount:0,lastUpdated:new Date};default:return e}}t.NotificationProvider=e=>{let{children:t,fetchNotifications:r,onMarkAsRead:l,onMarkAllAsRead:c,onDeleteNotification:f,fetchOptions:d={retryCount:3,retryDelay:1e3,timeout:1e4},initialState:y={}}=e,[p,m]=(0,o.useReducer)(s,{...n,...y}),g=(0,o.useRef)(d);(0,o.useEffect)(()=>{g.current=d},[d]),(0,o.useEffect)(()=>{r&&N()},[r]);let N=(0,o.useCallback)(async()=>{if(r)try{m({type:"FETCH_NOTIFICATIONS_REQUEST"});let e=await (0,a.fetchWithRetry)(r,g.current);m({type:"FETCH_NOTIFICATIONS_SUCCESS",payload:e})}catch(e){m({type:"FETCH_NOTIFICATIONS_FAILURE",payload:e instanceof Error?e.message:"Failed to fetch notifications"})}},[r]),C=(0,o.useCallback)(async e=>{if(l)try{await l(e)}catch(e){throw console.error("Error marking notification as read:",e),e}m({type:"MARK_AS_READ",payload:e})},[l]),h=(0,o.useCallback)(async()=>{if(c)try{await c()}catch(e){throw console.error("Error marking all notifications as read:",e),e}m({type:"MARK_ALL_AS_READ"})},[c]),I=(0,o.useCallback)(async e=>{if(f)try{await f(e)}catch(e){throw console.error("Error deleting notification:",e),e}m({type:"DELETE_NOTIFICATION",payload:e})},[f]),v=(0,o.useCallback)(e=>{m({type:"ADD_NOTIFICATION",payload:e})},[]),E=(0,o.useCallback)(()=>{m({type:"CLEAR_ALL_NOTIFICATIONS"})},[]),_=(0,o.useCallback)(async()=>{await N()},[N]),w={...p,addNotification:v,markAsRead:C,markAllAsRead:h,deleteNotification:I,clearAllNotifications:E,refreshNotifications:_};return(0,i.jsx)(u.Provider,{value:w,children:t})},t.useNotifications=()=>{let e=(0,o.useContext)(u);if(void 0===e)throw Error("useNotifications must be used within a NotificationProvider");return e}},4580:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.useNotificationFilters=void 0;let i=r(2265),o=r(3133),a=r(7201);t.useNotificationFilters=()=>{let{notifications:e}=(0,o.useNotifications)(),[t,r]=(0,i.useState)({}),n=(0,i.useMemo)(()=>(0,a.filterNotifications)(e,t),[e,t]),u=(0,i.useCallback)(e=>{r(t=>({...t,read:e}))},[]),s=(0,i.useCallback)(e=>{r(t=>({...t,type:e}))},[]),l=(0,i.useCallback)(e=>{r(t=>({...t,search:e}))},[]);return{filters:t,filteredNotifications:n,filterByReadStatus:u,filterByType:s,filterBySearch:l,filterByDateRange:(0,i.useCallback)((e,t)=>{r(r=>({...r,fromDate:e,toDate:t}))},[]),resetFilters:(0,i.useCallback)(()=>{r({})},[]),countsByType:(0,i.useMemo)(()=>e.reduce((e,t)=>{let r=t.type||"default";return e[r]=(e[r]||0)+1,e},{}),[e]),totalCount:e.length,filteredCount:n.length,unreadCount:e.filter(e=>!e.read).length}}},6178:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.useNotificationGroups=void 0;let i=r(2265),o=r(3133),a=r(7201);t.useNotificationGroups=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.groupNotificationsByDate,{notifications:t}=(0,o.useNotifications)(),r=(0,i.useMemo)(()=>e(t),[t,e]),n=(0,i.useMemo)(()=>Object.keys(r),[r]);return{groupedNotifications:r,groups:n,getNotificationsForGroup:e=>r[e]||[],groupedByType:(0,i.useMemo)(()=>t.reduce((e,t)=>{let r=t.type||"default";return e[r]||(e[r]=[]),e[r].push(t),e},{}),[t])}}},1732:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.useNotificationPolling=void 0;let i=r(2265),o=r(3133),a=r(7201);t.useNotificationPolling=function(){let{enabled:e=!0,interval:t=6e4,onError:r,retryCount:n=3,retryDelay:u=1e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{refreshNotifications:s}=(0,o.useNotifications)(),l=(0,i.useRef)(null),c=(0,i.useRef)(e),f=(0,i.useCallback)(async()=>{try{await (0,a.fetchWithRetry)(s,{retryCount:n,retryDelay:u})}catch(e){r?r(e):console.error("Error polling notifications:",e)}},[s,n,u,r]);return(0,i.useEffect)(()=>(c.current=e,e&&(f(),l.current=setInterval(f,t)),()=>{l.current&&(clearInterval(l.current),l.current=null)}),[e,t,f]),{refresh:f,stopPolling:(0,i.useCallback)(()=>{c.current=!1,l.current&&(clearInterval(l.current),l.current=null)},[]),startPolling:(0,i.useCallback)(()=>{c.current=!0,l.current&&clearInterval(l.current),f(),l.current=setInterval(f,t)},[f,t]),isPolling:()=>c.current}}},4344:function(e,t,r){let i;Object.defineProperty(t,"__esModule",{value:!0}),t.useNotificationStorage=void 0;let o=r(2265),a=r(3133),n=(i={},{getItem:e=>{var t;return null!==(t=i[e])&&void 0!==t?t:null},setItem:(e,t)=>{i[e]=t},removeItem:e=>{delete i[e]}});t.useNotificationStorage=function(){let{storageKey:e="notifications",useSessionStorage:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{notifications:r,addNotification:i,markAsRead:u,markAllAsRead:s,deleteNotification:l,clearAllNotifications:c}=(0,a.useNotifications)(),[f,d]=(0,o.useState)(n);return(0,o.useEffect)(()=>{"undefined"!=typeof window&&d(t?sessionStorage:localStorage)},[t]),(0,o.useEffect)(()=>{try{let t=f.getItem(e);t&&JSON.parse(t).forEach(e=>{i(e)})}catch(e){console.error("Error loading notifications from storage:",e)}},[f,e,i]),(0,o.useEffect)(()=>{try{f.setItem(e,JSON.stringify(r))}catch(e){console.error("Error saving notifications to storage:",e)}},[r,f,e]),{addNotification:async e=>{i(e)},markAsRead:async e=>{await u(e)},markAllAsRead:async()=>{await s()},deleteNotification:async e=>{await l(e)},clearAllNotifications:()=>{c()},clearStorage:()=>{f.removeItem(e)}}}},6175:function(e,t,r){t.i$=t.HH=t.Bt=t.v3=t.uj=t.zn=t.JB=void 0;var i=r(3133);Object.defineProperty(t,"JB",{enumerable:!0,get:function(){return i.NotificationProvider}}),Object.defineProperty(t,"zn",{enumerable:!0,get:function(){return i.useNotifications}});var o=r(1732);Object.defineProperty(t,"uj",{enumerable:!0,get:function(){return o.useNotificationPolling}});var a=r(4344);Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return a.useNotificationStorage}});var n=r(4580);Object.defineProperty(t,"Bt",{enumerable:!0,get:function(){return n.useNotificationFilters}});var u=r(6178);Object.defineProperty(t,"HH",{enumerable:!0,get:function(){return u.useNotificationGroups}});var s=r(7201);Object.defineProperty(t,"i$",{enumerable:!0,get:function(){return s.formatTimestamp}})},7201:function(e,t){async function r(e,t={}){let{retryCount:r=3,retryDelay:i=1e3,timeout:o=1e4}=t,a=null;for(let t=0;t<=r;t++)try{let t=new Promise((e,t)=>{setTimeout(()=>{t(Error(`Request timed out after ${o}ms`))},o)});return await Promise.race([e(),t])}catch(o){if(a=o instanceof Error?o:Error(String(o)),t===r)throw a;let e=i*Math.pow(2,t);await new Promise(t=>setTimeout(t,e))}throw a||Error("Unknown error during fetch with retry")}Object.defineProperty(t,"__esModule",{value:!0}),t.filterNotifications=t.groupNotificationsByDate=t.formatTimestamp=t.fetchWithRetry=void 0,t.fetchWithRetry=r,t.formatTimestamp=function(e){let t="string"==typeof e?new Date(e):e,r=Math.floor((new Date().getTime()-t.getTime())/1e3);if(r<60)return"just now";if(r<3600){let e=Math.floor(r/60);return`${e} ${1===e?"minute":"minutes"} ago`}if(r<86400){let e=Math.floor(r/3600);return`${e} ${1===e?"hour":"hours"} ago`}{if(!(r<604800))return t.toLocaleDateString();let e=Math.floor(r/86400);return`${e} ${1===e?"day":"days"} ago`}},t.groupNotificationsByDate=function(e){return e.reduce((e,t)=>{let r=("string"==typeof t.timestamp?new Date(t.timestamp):t.timestamp).toDateString();return e[r]||(e[r]=[]),e[r].push(t),e},{})},t.filterNotifications=function(e,t){return e.filter(e=>{var r,i;if(void 0!==t.read&&e.read!==t.read||t.type&&e.type!==t.type)return!1;if(t.search){let o=t.search.toLowerCase(),a=null===(r=e.title)||void 0===r?void 0:r.toLowerCase().includes(o),n=null===(i=e.message)||void 0===i?void 0:i.toLowerCase().includes(o);if(!a&&!n)return!1}if(t.fromDate||t.toDate){let r="string"==typeof e.timestamp?new Date(e.timestamp):e.timestamp;if(t.fromDate&&r<t.fromDate)return!1;if(t.toDate){let e=new Date(t.toDate);if(e.setDate(e.getDate()+1),r>e)return!1}}return!0})}}}]);